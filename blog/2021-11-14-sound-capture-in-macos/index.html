<!doctype html><html lang=ru-ru><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.71.1"><title>Захват звука в macOS | Vitaly Khabarov</title><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://vitkhab.pro/blog/2021-11-14-sound-capture-in-macos/cover.png"><meta name=twitter:title content="Захват звука в macOS"><meta name=twitter:description content="Для стриминга экрана через OBS хватит бесплатного BlackHole. Если вам нужна запись звонков, то посмотрите SWB Audio. Для сложных кейсов - только Loopback. Что это и как использовать, читайте в статье."><meta property="og:title" content="Захват звука в macOS"><meta property="og:description" content="Для стриминга экрана через OBS хватит бесплатного BlackHole. Если вам нужна запись звонков, то посмотрите SWB Audio. Для сложных кейсов - только Loopback. Что это и как использовать, читайте в статье."><meta property="og:type" content="article"><meta property="og:url" content="https://vitkhab.pro/blog/2021-11-14-sound-capture-in-macos/"><meta property="og:image" content="https://vitkhab.pro/blog/2021-11-14-sound-capture-in-macos/cover.png"><meta property="article:published_time" content="2021-11-14T00:00:00+00:00"><meta property="article:modified_time" content="2021-11-14T12:51:36+03:00"><link href=https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css rel=stylesheet integrity=sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T crossorigin=anonymous><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.0.13/css/all.css integrity=sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp crossorigin=anonymous><link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel=stylesheet><link href=/css/medium.css rel=stylesheet><link href=/css/additional.css rel=stylesheet><link href=/css/extra.css rel=stylesheet></head><body><nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top mediumnavigation nav-down"><div class="container pr-0"><a class=navbar-brand href=https://vitkhab.pro/><span style=font-family:Righteous>Vitaly Khabarov</span></a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarMediumish aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarMediumish><ul class="navbar-nav ml-auto"><li class=nav-item><a class=nav-link href=/blog>Статьи</a></li><li class=nav-item><a class=nav-link href=/presentations>Презентации</a></li><li class=nav-item><a class=nav-link href=/projects>Проекты</a></li><li class=nav-item><a class=nav-link href=/>Обо Мне</a></li></ul></div></div></nav><div class=site-content><div class=container><div class=mainheading><h1 class=sitetitle>Vitaly Khabarov</h1><p class=lead>прo технологии и разработку цифровых продуктов</p></div><div class=main-content><div class=container><div class=row><div class="col-md-2 pl-0"><div class="share sticky-top sticky-top-offset"><p>Share</p><ul><li class="ml-1 mr-1"><a target=_blank href="https://twitter.com/intent/tweet?text=%d0%97%d0%b0%d1%85%d0%b2%d0%b0%d1%82%20%d0%b7%d0%b2%d1%83%d0%ba%d0%b0%20%d0%b2%20macOS&url=https%3a%2f%2fvitkhab.pro%2fblog%2f2021-11-14-sound-capture-in-macos%2f" onclick="window.open(this.href,'twitter-share','width=550,height=435');return false;"><i class="fab fa-twitter"></i></a></li><li class="ml-1 mr-1"><a target=_blank href="https://facebook.com/sharer.php?u=https%3a%2f%2fvitkhab.pro%2fblog%2f2021-11-14-sound-capture-in-macos%2f" onclick="window.open(this.href,'facebook-share','width=550,height=435');return false;"><i class="fab fa-facebook-f"></i></a></li><li class="ml-1 mr-1"><a target=_blank href="https://www.xing.com/spi/shares/new?url=https%3a%2f%2fvitkhab.pro%2fblog%2f2021-11-14-sound-capture-in-macos%2f" onclick="window.open(this.href,'xing-share','width=550,height=435');return false;"><i class="fab fa-xing"></i></a></li></ul><div class=sep></div><ul><li><a class="small smoothscroll" href=#disqus_thread></a></li></ul></div></div><div class="col-md-9 flex-first flex-md-unordered"><div class=mainheading><div class="row post-top-meta"><div class="col-xs-12 col-md-3 col-lg-2 text-center text-md-left mb-4 mb-md-0 md-nopad-right"><img class=author-thumb src=/images/vitkhab.webp alt="Виталик Хабаров"></div><div class="col-xs-12 col-md-9 col-lg-10 text-center text-md-left md-nopad-left"><a target=_blank class=link-dark>Виталик Хабаров</a><br><span class=author-description>Энтузиаст разработки цифровых продуктов<br><i class="far fa-star"></i>Nov 14, 2021
<i class="far fa-clock clock"></i>6 min read</span></div></div><h1 class=posttitle>Захват звука в macOS</h1></div><div class=article-post><p>В macOS из коробки нет возможности записать системный звук. При записи звонка сторонними приложениями будет слышен только ваш микрофон, при стриминге игры видео будет без звука, запись онлайн трансляции с экрана будет как немое кино. Исключение - Zoom. При показе экрана он умеет перехватывать системный звук. А Discord и Telegram - нет.</p><p>Я расскажу о найденных мной решениях и в конце поделюсь <a href=#%D0%BF%D1%80%D0%B8%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%B8%D1%8F>впечатлениями об упомянутых программах</a>.</p><blockquote><p>TL;DR Для стриминга экрана через <a href=#obs>OBS</a> хватит бесплатного <a href=#blackhole>BlackHole</a>.<br>Если вам нужна запись звонков, то посмотрите <a href=#swb-audio>SWB Audio</a>. Перед покупкой обязательно попробуйте его в своих сценариях.<br>Для сложных кейсов - только <a href=#loopback>Loopback</a>.</p></blockquote><h1 id=захват-аудио>Захват аудио</h1><p>Самое простое - перехватить весь системный звук и куда-то его направить. С этим справится <a href=#blackhole>BlackHole</a> (бесплатно) или <a href=#vb-cable>VB-Cable</a> (бесплатно). Эти программы создают виртуальный звуковой интерфейс, который транслирует на выход то, что он получил на вход. Я буду называть их аудио-мостом.</p><p><img src=images/audio-bridge.jpg alt="Audio bridge"></p><p>После установки выбираем нужно в приложении Audio MIDI Setup создать Multi-Output Device и выбрать в нем интерфейс аудио-моста и наушники или колонки. Без Multi-Output Device звук будет идти только на одно устройство. У вас не будет записи или вы не будете слышать системный звук.</p><p>Далее в настройках звука выберите в устройствах воспроизведения Multi-Output Device. В приложении для записи укажите аудио-мост в качестве микрофона.</p><p>MacOS позволяет дублировать звук на несколько устройств, но не умеет нормально собирать его с нескольких источников. Поэтому такая схема работает, когда вам не нужна запись микрофона или приложение самое поддерживает работу с несколькими записывающими устройствами. Например, как OBS. То есть для стриминга вполне подходит.</p><p><img src=images/multi-output-device.jpg alt="Multi-Output Device layout"></p><p>Хуже, когда приложение умеет работать только с одним источником звука и в него нужно передать системный звук и звук с микрофона. Мне как раз такое потребовалось во время онлайн урока по вокалу. Преподавателю нужно слышать мелодию и мой голос, чтобы оценить качество выполнения упражнения. Мелодию я запускаю у себя, чтобы не было лишнего лага.</p><p>Для решения этой задачи я на коленке собрал схему ниже. Установил две программы-аудио-моста. На первый аудио-мост завел системный звук. В OBS завел первый мост и микрофон разными устройствами. Включил мониторинг аудио-интерфейсов, OBS дублирует входящий сигнал на указанное устройство воспроизведения. В качестве монитора указал Multi-Output Device с наушниками и вторым аудио-мостом. В приложения для звонка выбрал второй аудио-мост в качестве микрофона.</p><p>Получилось дешево и сердито. Чтобы схема работала, нужно держать OBS включенным. Что неудобно.</p><p><img src=images/multi-output-device-with-obs.jpg alt="Multi-Output Device layout with OBS"></p><p>При подготовке поста я узнал о <a href=#swb-audio>SWB Audio</a> ($12 в год). Оно уже умеет добавлять к выходному сигналу звук с микрофона. Но перед покупкой обязательно протестируйте SWB Audio на своих сценариях. Чтобы вас не постигло разочарование, как меня.</p><p>У меня внешний звуковой интерфейс Focusrite Scarlett Solo. У него два входных канала, для микрофона и линейный вход для музыкального инструмента. ОС воспринимает их как два отдельных канала, левый и правый. На момент написания поста SWB Audio не позволяет трансформировать сигнал в моно. Поэтому мои собеседники могли слышать меня только в левом ухе.</p><p><img src=images/multi-output-device-with-swb-audio.jpg alt="Multi-Output Device layout wuth SWB Audio"></p><p>Выходом для меня стал <a href=#loopback>Loopback</a> ($99 + $20 налогов). Который умеет создавать любое количество виртуальных интерфейсов, забирать звук с отдельных приложений, маршрутизировать аудио каналы и сохранять их как отдельные схемы, которые можно включать или отключать по мере необходимости. Если ваши задачи выходят за рамки простого захвата системного звука, то я не знаю варианта лучше Loopback.</p><p><img src=images/loopback-vocal-lessons.png alt="Loopback interface"></p><h1 id=приложения>Приложения</h1><h2 id=blackhole>BlackHole</h2><p>Виртуальный интерфейс аудио-мост. Без интерфейса для управления или мониторинга сигнала. Ничего лишнего, просто работает.</p><p>Единственное приложение, которое не запросило у меня разрешения на загрузку своего драйвера в Security & Privacy. Я его устанавливал последним из всего списка приложений. Потому возможно, BlackHole переиспользовал ранее поставленный драйвер.</p><p>Проект с <a href=https://github.com/ExistentialAudio/BlackHole>открытым исходным кодом</a>. Streamlabs <a href=https://existential.audio/blackhole/>рекомендуют</a> его для использования. Скачать можно <a href=https://streamlabs.com/content-hub/post/capturing-desktop-audio-in-streamlabs-obs-for-mac>подписавшись на рассылку</a> или через Homebrew.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>brew install blackhole-2ch
brew install blackhole-16ch
</code></pre></div><h2 id=vb-cable>VB-Cable</h2><p>Виртуальный интерфейс аудио-мост. Через графический интерфейс можно посмотреть наличие сигнала. Если нужно больше одного интерфейса, можно поставить еще четыре (отдельными приложениями). При установке требует разрешить загрузку своего драйвера.</p><p>Скачать можно на <a href=https://vb-audio.com/Cable/>сайте разработчика</a>.</p><p><img src=images/vb-cable-ui.png alt="VB-Cable UI"></p><h2 id=loopback>Loopback</h2><p>Полноценный машрутизатор звука. Стоит $99 + локальные налоги $20, итого - $119.</p><p>Позволяет снимать как весь системный звук через аудио-мост, так и звук с отдельных приложений. Смешивать каналы как угодно. Создавать несколько виртуальных интерфейсов под разные задачи.</p><p>Для нестандартных задач - must have. Я могу направить в OBS только звук голосового чата. В Zoom микрофон и музыкальный плеер. В запись QuickTime Player весь системный звук. Продублировать левый канал звуковой карты, там у меня микрофон, на каждый исходящий канал. Могу мониторить исходящий звук.</p><p>Все программы разработчика требуют <a href="https://rogueamoeba.com/support/knowledgebase/?showArticle=ACE-BigSur">установки Audio Capture Engine</a>. Для этого придется перезагрузиться в Recovery enironment и разрешить в Security Policy установку kernel extension&rsquo;ов от одобренных разработчиков.</p><p>Скачать и купить можно на <a href=https://rogueamoeba.com/loopback/>сайте разработчика</a>.</p><p><img src=images/loopback-interface.png alt="Loopback interface"></p><h2 id=swb-audio-capture>SWB Audio Capture</h2><p>Виртуальный интерфейс аудио-мост, который используют приложения <a href=#swb-audio>SWB Audio</a> и <a href=#ishow-instant>iShow Instant</a>. Цена зависит от используемой программы. Без активной лицензии, драйвер периодически подмешивает watermark сообщение в выходной аудио поток. При установке требует разрешить загрузку своего драйвера.</p><p>Для захвата звука в macOS <a href=https://obsproject.com/wiki/OBS-Studio-Quickstart#2-set-up-your-audio-devices>документация OBS</a> ссылается на <a href=https://obsproject.com/forum/resources/os-x-capture-audio-with-ishowu-audio-capture.505/>форум</a>. Там ссылка на <a href=https://support.shinywhitebox.com/hc/en-us/articles/204161459-Installing-iShowU-Audio-Capture>&ldquo;101% free&rdquo; приложение</a>, где нас встречает гигантский баннер &ldquo;Обновились на BigSur? Старое приложение не работает, качайте <a href=#swb-audio>SWB Audio</a> (за $12 в год)". Но раньше баннера не было (или я его проигнорировал) и я скачал устаревший драйвер iShowU Audio Capture. Он не заработал. Погуглил, нашел <a href=#ishow-instant>iShow Instant</a>, который сам обновил драйвер на SWB Audio Capture.</p><p>На <a href="https://www.youtube.com/watch?v=FvmqlHzP4-s">нулевом стриме DevOps Гаража</a> узнал, что без лицензии драйвер подмешивает в выход фразу &ldquo;SWB Audio Capture is not registered&rdquo;. На <a href="https://www.youtube.com/watch?v=rVxvF0vrXS4">первом стриме DevOps Гаража</a> я узнал, что купленный iShow Instant нужно держать запущенным, иначе драйвер также подмешивает ту же фразу.</p><h3 id=swb-audio>SWB Audio</h3><p>Приложение для захвата звука поверх аудио-моста <a href=#swb-audio-capture>SWB Audio Capture</a> за $12 в год. Активирует драйвер SWB Audio Capture.</p><p>Умеет захватывать микрофон, но не умеет управлять каналами. Из-за этого меня собеседники слышат только левым ухом. У меня внешняя звуковая карта, где левый канал - микрофон, а правый - музыкальный инструмент.</p><p>Позволяет мониторить выходную дорожку и микрофон. У меня работает с заметной задержкой.</p><p>Скачать можно на <a href=https://shinywhitebox.com/swb-audio-app>сайте разработчика</a>.</p><p><img src=images/swb-audio-interface.png alt="SWB Audio interface"></p><h3 id=ishow-instant>iShow Instant</h3><p>Приложение для записи экрана. Активирует драйвер <a href=#swb-audio-capture>SWB Audio Capture</a>. Стоит $24 + $4.8 локальных налогов, итого - $28.8. Разово.</p><p>К сожалению, не умеет передавать микрофон в выход, только записывать. Также при записи захватывает сигнал с аудио-моста. Можно из входного левого канала микрофона сделать моно сигнал и его будет слышно с обеих сторон. Для правого так тоже можно =)</p><p>Подойдет для записи экрана, для стриминга через OBS. Но не более.</p><p>Скачать можно на <a href=https://shinywhitebox.com/ishowu-instant>сайте разработчика</a>.</p><p><img src=images/ishow-instant-interface.png alt="iShow Instant interface"></p><h2 id=obs>OBS</h2><p>Бесплатное приложение для записи экрана и стриминга. Со своей задачей справляется хорошо. Есть куча расширенний.</p><p>В статье я использовал OBS для маршрутизации звука на коленке. С этим он справляется, но рекомендовать для этого не буду.</p><p>Скачать можно с <a href=https://obsproject.com/>официального сайта</a>. Также доступна <a href=https://streamlabs.com/>сборка от Streamlabs</a>. Базовая функциональность также бесплатно, а вот за дополнительные фичи попросят денежку.</p><p><img src=images/obs-interface.png alt="OBS Interface"></p></div><div class=after-post-tags><ul class=tags><li><a href=/tags/other>other</a></li><li><a href=/tags/audio>audio</a></li><li><a href=/tags/streaming>streaming</a></li></ul></div><div class="row PageNavigation d-flex justify-content-between font-weight-bold"><a class="d-block col-md-6 text-lg-right" href=https://vitkhab.pro/blog/2020-05-26-notion-office-hourse-tiago-forte/>Notion Office Hours: Tiago Forte &#187;</a><div class=clearfix></div></div></div></div></div><div class=container><div id=comments class="row justify-content-center mb-5"><div class=col-md-8><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return;}
var d=document,s=d.createElement('script');s.async=true;s.src='//'+"vitkhab-pro"+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div></div></div></div><div class="jumbotron fortags"><div class="d-md-flex h-100"><div class="col-md-4 transpdark align-self-center text-center h-100"><div class="d-md-flex align-items-center justify-content-center h-100"><h2 class="d-md-block d-none align-self-center py-1 font-weight-light">Explore <span class="d-none d-md-inline">→</span></h2></div></div><div class="col-md-8 p-5 align-self-center text-center"><a class="mt-1 mb-1" href=/tags/audio>audio</a>
<a class="mt-1 mb-1" href=/tags/blog>blog</a>
<a class="mt-1 mb-1" href=/tags/complicated-subsystem-team>complicated-subsystem-team</a>
<a class="mt-1 mb-1" href=/tags/devops>devops</a>
<a class="mt-1 mb-1" href=/tags/enabling-team>enabling-team</a>
<a class="mt-1 mb-1" href=/tags/github-pages>github-pages</a>
<a class="mt-1 mb-1" href=/tags/hugo>hugo</a>
<a class="mt-1 mb-1" href=/tags/meetup>meetup</a>
<a class="mt-1 mb-1" href=/tags/other>other</a>
<a class="mt-1 mb-1" href=/tags/personal-brand>personal-brand</a>
<a class="mt-1 mb-1" href=/tags/platform-team>platform-team</a>
<a class="mt-1 mb-1" href=/tags/presentation>presentation</a>
<a class="mt-1 mb-1" href=/tags/stream-aligned-team>stream-aligned-team</a>
<a class="mt-1 mb-1" href=/tags/streaming>streaming</a>
<a class="mt-1 mb-1" href=/tags/team-topologies>team-topologies</a>
<a class="mt-1 mb-1" href=/tags/%D0%B7%D0%B0%D0%BF%D0%B8%D1%81%D1%8C>запись</a>
<a class="mt-1 mb-1" href=/tags/%D0%BA%D0%BE%D0%BD%D1%81%D0%BF%D0%B5%D0%BA%D1%82>конспект</a>
<a class="mt-1 mb-1" href=/tags/%D1%83%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%B7%D0%BD%D0%B0%D0%BD%D0%B8%D1%8F%D0%BC%D0%B8>управление-знаниями</a></div></div></div><footer class=footer><div class=container><div class=row><div class="col-md-6 col-sm-6 text-center text-lg-left">&copy; Copyright Vitaly Khabarov - All rights reserved</div><div class="col-md-6 col-sm-6 text-center text-lg-right"><a target=_blank rel=noopener href=https://www.wowthemes.net>Mediumish Theme</a> by WowThemes.net</div></div></div></footer></div><script src=https://code.jquery.com/jquery-3.4.1.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js integrity=sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut crossorigin=anonymous></script><script src=https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js integrity=sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM crossorigin=anonymous></script><script src=/js/mediumish.js></script><script type=text/javascript>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
(window,document,"script","https://mc.yandex.ru/metrika/tag.js","ym");ym("61600576","init",{clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src=https://mc.yandex.ru/watch/61600576 style=position:absolute;left:-9999px alt></div></noscript><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-154958457-1','auto');ga('send','pageview');}</script></body></html>